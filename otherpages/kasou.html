<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>愛の妖精ぱらんてぃんの極まりないズサン運営救世おまんこ</title>
</head>
<body>
    <center>
        <h1>かそうかんきょうのはなし</h1>
    </center>
    エロゲーを好むオタクの方々にとって最大の関門である「動作環境」. 駿河屋で良さげな作品を発掘したのに批評空間を当たってみたらWin7以降で動作不可,
    などの表記を見てがっかりしたことは一度や二度ではないだろう. 互換モードやInst2000などの手法もあるが, やはり限界があるのは事実. そんな時に脳裏に浮かぶのは仮想環境の構築である.
    しかし意外とこの構築は難しく, またネットに情報も少ない. このページではそんな諸兄姉のためにWindows98SEの仮想環境構築においてつまずきやすいポイントを箇条書きでまとめていく. <br>
    なお, 想定するホスト環境は以下である. (学生なので激安ラップトップです...)
    <ul>
        <li>OS:Windows11 Home 24H2</li>
        <li>CPU:13th Gen Intel(R) Core(TM) i7-13650HX (2.60 GHz)</li>
        <li>メモリ:16GB</li>
        <li>グラフィック:Intel(R) UHD Graphics, NVIDIA GeForce RTX 4060 Laptop GPU</li>
        <li>仮想化ソフト:VMware</li>
    </ul>
    <ol>
        <li>下準備</li>
        <ul>
            <li>本体ディスクの用意</li>
            <ul>
                <li>ヤフオク等で数千円～1万円前後で購入できる. 注意点は2つ. まずプロダクトコードが付属していることを出品者に確認すること. ないとインストールできない. 
                もう一つは間違ってアップグレード版を購入しないこと. アップグレード版を購入してしまうとWin95が必要になる. 
                </li>
                <li><s>どうしても手に入らない場合はInternet Archiveにアップロードされているディスクイメージを使うという手もある. </s></li>
                <li>ディスクは必ずイメージファイルに焼く. そのほうが後々楽であり, 以下ではisoに焼かれたものとして話を進める. Imgburn等のソフトを使う. 特段コピーガードはかかっていないはずである. </li>
            </ul>
            <li>ブートディスクの用意</li>
            <ul>
                <li>Linuxを普段使いする異常者を除けばもはや過去の遺物となったブートディスク. OS本体のインストールに必要なMS-DOSが入った記録媒体である. </li>
                <li>Win98SEのブートディスクはフロッピーディスクである. 21世紀生まれの9割は実物を見たこともないだろう. </li>
                <li>おそらく上記のステップでディスクを購入してもブートディスクまでは付属していないし, 仮に付属していたとしても今のパソコンにフロッピー読み込み口はついていない. </li>
                <li>なのでイメージをダウンロードするか, または自力で製作することになる. 
                    <a href="https://radioc.web.fc2.com/soflib/mkw9ximg/mkimage.htm">こちらのサイト</a>にディスクからブートディスクを作成するソフトが掲載されている. 
                    FC2ブログなんていういつ閉鎖されてもおかしくない場所に掲載されているので, もしリンクが死んでたらInternet Archive等を確認してほしい. </li>
            </ul>
            <li>その他の用意</li>
            <ul>
                <li>後々必要になるものをここでそろえておく. </li>
                <li>比較的新しいPCではCPUのスペックがWin98SEの想定を大きく超えてしまい, 不具合が起きることが報告されている. 
                    有志の手でパッチが製作されているので<a href="https://github.com/JHRobotics/patcher9x">こちら</a>よりダウンロードする. </li>
                <li>VMwareではVM toolsと呼ばれる互換性の改善のためのツールが公開されており, これがないと使い物にならないので, 
                    <a href="https://packages-prod.broadcom.com/tools/frozen/windows/">こちら</a>より「winPre2k.iso」をダウンロードする. </li>
                <li>Win98SEインストール後, 音が出ない場合がある. その場合は<a href="https://support.creative.com/downloads/searchdownloads.aspx?nLanguageLocale=1033&filename=ct4700&nPage=1">こちら</a>よりドライバ
                    「Sound Blaster PCI cards Web Update for users running Windows 98SE, Windows ME, Windows 2000 or Windows XP.」をダウンロード. </li>
                <li>Win98SEインストール後, 音が全体的に歪んで発せられるケースがある. 
                    こちらも有志によりパッチが公開されているので<a href="https://github.com/Raymai97/VMAudioBackHost/">こちら</a>よりダウンロード. </li>
            </ul>
        </ul>
        <li>マシンの作成～ブート</li>
        <ul>
            <li>マシンの作成</li>
            <ul>
                <li>「ゲストOSのインストール」では「後でOSをインストール」を選択.</li>
                <li>ディスク容量は用途による. エロゲーをたくさん入れたいなら16～32GB程度. 64GBを超えると不具合が起きるのでそれ以下にする. </li>
                <li>「仮想マシンを作成する準備完了」まで来たら「ハードウェアをカスタマイズ」を選択.</li>
                <li>まずネットワークアダプタを削除. これはセキュリティがガバガバどころかスカスカのWin98が間違ってもインターネットに接続されることを防ぐ予防的措置.</li>
                <li>続いて「追加...」からフロッピーディスクドライブを追加. 「起動時に接続」にチェックを入れ, 接続先に先ほど作成したフロッピーイメージを選択. </li>
                <li>さらに新規CD・DVDにも起動時に接続のチェックを入れ, 接続先にWin98SE本体のディスクイメージを指定. </li>
                <li>ここまで完成したら「完了」を押す. </li>
            </ul>
            <li>ブート</li>
            <ul>
                <li>MS-DOSの操作に慣れていない我々Z世代にとってはここが一番の難関である. </li>
                <li>まずCD-ROMでインストールするか聞かれるので「1」を選択.</li>
                <li>続いてキーボードの種類を聞かれるので指示通り「漢字」キー(普通はあると思うがなければspaceキー)を押す. </li>
                <li>そしたら待機画面に移行するので「fdisk」と打ち込み実行. きょうびfdiskといえばlinux用語である. </li>
                <li>大容量ハードディスクを有効にするか聞かれるので「y」を選択. </li>
                <li>fdiskが終了したら「restart」と打ち込み再起動. </li>
                <li>再起動がかかったら同じ操作を繰り返しfdiskを打ち込んだ画面まで戻ってくる. ここで今度は「format c:」と打ち込み実行. </li>
                <li>Cドライブのフォーマット完了後, windowsをインストールするディレクトリの名前を聞かれるので「windows」とでもしておく. 変な名前にすると後が面倒なので注意. </li>
                <li>続いて「D:」と打ち込みDドライブに移動. 「setup」と打ち込みEnter. ディスクチェックが行われる. おそらくエラーは出ないはずなので「終了」を選択</li>
            </ul>
        </ul>
        <li>セットアップ～起動</li>
        <ul>
            <li>パッチ適用</li>
            <ul>
                <li>「Wiodows98セットアップ」の画面に遷移したら一度スナップショットを取る. ミスがあったときにもう一回ブートからやり直すのは面倒だからである. </li>
                <li>この時点でフロッピーディスクドライブの設定を開き,「接続済み」「起動時に接続」のチェックを外す. こうしておかないと再起動がかかったときにまたブートディスクから読み込まれる. </li>
                <li>しばらくは指示通り. 起動ディスクを作成するか聞かれるが「作る」を押してもエラーが出るだけなので「キャンセル」を押して先に進む. </li>
                <li>「ウィザードの開始」という画面でスナップショットを取る. ここから少し面倒な作業が入る. </li>
                <li>おそらくそのまま先に進むと「SHELL32.DLLは欠落エクスポートGDI32.DLLにリンクされています.」なるエラーが出て先に進めなくなる. 
                    これは2GHz以上のCPUを搭載している(Win98の時代では想定外の高性能)パソコンにWin98をインストールしようとした際に起こるエラーで, CPUの速度チェック時にゼロ除算が発生することに起因する. </li>
                <li>ここで先ほどダウンロードしたパッチ「patcher9x」を適用する. 「ウィザードの開始」画面に戻ったらフロッピーディスクドライブに「patcher9x-0.8.50-boot.ima」をマウントし, 「接続済み」「起動時に接続」のチェックを入れる. </li>
                <li>さっきのDOS画面が起動するので「patch9x」と打ち込みEnter, 続いてインストール場所を聞かれるのでそのままEnter. 次に0～4の選択肢でパッチ適用の詳細を聞かれるので「4」を選択しEnter. 
                    最後に確認されるので「y」を打ち込む. するとパッチが適用される. </li>
                <li>適用が終わったら「接続済み」「起動時に接続」のチェックを外してVMware の上のほうにある「Ctrl+Alt+Del を送信」から再起動. 正しく適用できていればエラーなく先に進める. </li>
            </ul>
            <li>起動～ドライバの設定</li>
            <ul>
                <li>ここから起動までは特に困ることはないはず. </li>
                <li>起動後, VMwareのDドライブからWin98のディスクイメージを取り出し, 代わりに「winPre2k.iso」をマウント. 指示に従ってインストール. </li>
                <li>インストール後, マウスの動きが良くなり, またドラッグアンドドロップでファイルが移せるようになる. </li>
                <li>続いて再びWin98のディスクイメージをマウントし, サウンドドライバ「SBPCI_WebDrvsV5_12_01.exe」をドラッグアンドドロップで移して実行. これで音が出るようになる. </li>
                <li>音がゆがむ場合は「VMAudioBackHost」を起動し, バックグラウンドで数値を2.000などとしてStartで直るはずである. 残念ながらこのソフトはWin98を動かす際に毎回バックグラウンドで動かす必要がある. </li>
            </ul>
        </ul>
        <li>その他</li>
        <ul>
            <li>Win98SEはMe,XP等へのアップグレードディスクが存在するが, XP以降(2000もかも, 未検証)のWindowsにアップグレードする場合, 「winPre2k.iso」をアンインストールしてからアップグレードを行う必要がある. </li>
        </ul>
    </ol>

    
    <center>
        <a href="../others.html">もどる</a>
    </center>
</body>
</html>